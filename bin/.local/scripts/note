#!/usr/bin/env sh

NOTES_DIR=${PERSONAL-$HOME}/notes
mkdir -p "$NOTES_DIR"

case "$#" in
0)
    mkdir -p "$NOTES_DIR/calendar"
    note="$NOTES_DIR/calendar/$(date '+%Y%m%d')"
    ;;
*)
    note="$NOTES_DIR/$*"
    ;;
esac

if [ -t 0 ]; then
    (
        cd "$NOTES_DIR"
        $EDITOR "$note.md"
    )
else
    while read -r line; do
        echo "$line" >>"$note.md" || exit 1
    done
fi
